from urllib.request import *
from urllib.parse import *
import re
from bs4 import BeautifulSoup
import csv



class DrugInfoScraper:
	host = 'http://www.druginfo.co.kr'
	query_url = 'https://www.druginfo.co.kr/search2/search.aspx?q='	
	Cookie = 'ASP.NET_SessionId=scqnaj55dafokh551xpock45; userId=4b41bfdbce851c5c6054cb1cd08652039d8ee2ba4667212a3e60f477e41bf5a86a2bf9a3502bb31e56c9df50c4840d48; userIp=9ba91e4438eee45af0b3b1894b0c8275c7f7b9cb37f15852d47890dde19ba157591c2f11e027b27d95770e9c44a183ab; userName=4b41bfdbce851c5c6054cb1cd08652039d8ee2ba4667212a3e60f477e41bf5a86a2bf9a3502bb31e56c9df50c4840d48; userPid=821eb4cc42c9e7cf78e862ba364c0f7ec2ae58e3d5f020cb6f88445f715f9def2474b752c2f8c56cfa9b3d35b50793cd; userRole=29c54268c67af58cc7a52cb43b6e6f9fdb06a52942fdb8bb7abdd02b2a8b37e05bfebe9d097cafe2e4e5abfa29d45f84; userTime=6d062f244f9375adf43370ba9f6035fa65b836afe5e9a9d5cd5f903f0f196919893b79108d76f34c0cfeebbfb24e88ce; userJobSort=ee09654fd166be3a1edbd355910e162380ca9d56a7b5168adf9f9b851a90d8f8; userPoint=fe6c737e30d8212f60774d6f8906fcea5497b00e09df2ee3056008c9cc6414a6; userTel=dd2af4acba624126d1d1d3423ecd5fb503656272a3602d6f94d9dbf2010ee9246f616b17f670969125cd8de3ac8dc199; userEmail=b56ee86ed55f5cf1e2ee3b7a7ab57e138d03144e78deed3df75249b2c0efa021ba0c71c2d49221b0dbff2abc0e4a3d8c; userSummits=63909e4b140e52b890502e3f1e2bc6a64c6391fc8f99bd8dd393ec82097afb05; companyName=63909e4b140e52b890502e3f1e2bc6a64c6391fc8f99bd8dd393ec82097afb05; prevUrl=http://www.druginfo.co.kr/detail/product.aspx?pid=5939&; _ga=GA1.3.302705196.1464690478; __utma=133333467.302705196.1464690478.1464693111.1464697480.3; __utmb=133333467.3.10.1464697480; __utmc=133333467; __utmz=133333467.1464690478.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)'
	def GetSoupParserFromQueryPage(self, query):
		if not isinstance(query,str): query = str(query)
		url = self.query_url + quote(query.encode('cp949'))
		rsp = urlopen(url)
		return BeautifulSoup(rsp.read(),'html.parser')
	def GetDrugInfoHtml(self, drug_url):
		req = Request(drug_url)
		req.add_header('Cookie', self.Cookie)
		return urlopen(req).read()
	def GetDrugSearchTable(self, keyWord, bHeader = True):
		obj_soup = self.GetSoupParserFromQueryPage(keyWord)
		div_res = obj_soup.findAll('div',class_='res table-res')
		header = tables = []
		imgPat = re.compile('.+,(.+)')
		for div in div_res:
			# table = [tuple([td.text.strip() if td.string else td.a.text.strip()  if td.a else td.text.strip() for td in tr.find_all('td')]) for tr in div.table.find_all('tr')]
			table = []
			for tr in div.table('tr'):
				row = []
				td_data = None
				for td in tr('td'):
					if td.string:
						data = td.text.strip()
						if data == '조회':
							td_data = self.host + td.a.get('href')
						else:
							td_data = data
					else:
						if td.a:
							td_data = td.a.text.strip()
							if imgPat.match(td_data):
 								td_data = self.host + '/drugimg/' + imgPat.match(td_data).group(1)
						elif td.img:
							src = td.img.get('src')
							td_data = src[src.rfind('.')-1]
						else:
							td_data = None
					row.append(td_data)
				table.append(row)
				
			if "제품명" in table[0]:
				 header, *tuples = table
				 tables += tuples
		if bHeader:
			ret = [header] + tables if header else [keyWord, "검색어 오류"]
		else:
			ret = tables if header else [keyWord, "검색어 오류"]
		return  ret
	def GetDrugUrlFromEDICode(self, EDI_CODE):
		szCode = str(EDI_CODE)
		obj_soup = self.GetSoupParserFromQueryPage(szCode)
		if len(szCode) == 9 and szCode.isdigit():
			if obj_soup.find_all('div',id='msg-no-results'):
				return "about:blank"
			else:
				return self.host + obj_soup.find_all('a',class_='product-link preview-product')[0]['href']
		else: 
			return 'EDI code format error'
	def GetDrugImgUrlAndIDFromEDICode(self, EDI_CODE):
		imgUrlPath = "https://www.druginfo.co.kr/drugimg/"
		szCode = str(EDI_CODE)
		obj_soup = self.GetSoupParserFromQueryPage(szCode)
		try:
			imglnk = obj_soup.find_all('a',class_='pro-img-link')[0]
		except IndexError:
			return 0, 0
		else:
			imgfile = imglnk.text.split(',')
			return imgUrlPath + imgfile[1], imgfile[0]
	def GetDrugNameFromEDI(self, EDI_CODE):
		tbl = self.GetDrugSearchTable(EDI_CODE,False)
		if tbl: return tbl[0][1]



def WriteToCSV(tbl, csvFile):
	with open(csvFile,'wt', newline ='') as fp:
		wtr = csv.writer(fp)
		for row in tbl:
			wtr.writerow(row)


d = DrugInfoScraper()
edis = '668000040 668000050 668000100 668000110 668000120 668000130 668100250 668100410 668100550 668100680 668100870 668101020 668101240 668101241 668101390 668500020 668500021 668900440 668900670 668900970 668900990 668901000 668901110 668901340 668901390 668901410 668901411 668901440 668901770 668901890 668902010 668902170 668902580 668902610 668902620 668902630 668902640 668902650 668902670 668902700 668902701 668902880 668902910 669500640 669800030 669800080 669800100 669800160 669800280 669800320 669800390 669800470 669800800 669801030 669801630 669801631 669900170 669901180 669901570 669902290 669902291 669902300 669902360 669903700 669903790 669905750 670000120 670000130 670000150 670000260 670000500 670000510 670000580 670000600 670000610 670000990 670001000 670001820 670001830 670100330 670100630 670100840 670101000 670101330 670300280 670300490 670300700 670300701 670300840 670300841 670301060 670301150 670301260 670301360 670301363 670301460 670301520 670301540 670301740 670301770 670301772 670301780 670301930 670302150 670302180 670302181 670303990 652000490 652000491 652000520 652000570 652000581 652000590 652000591 652000860 652000861 652000870 652000871 652000910 652000911 652000920 652000921 652100010 652100011 652100030 652100130 652100150 652100151 652100160 652100161 652100190 652100200 652100210 652100211 652100240 652100241 652100260 652100261 652100270 652100271 652100290 652100300 652100310 652100360 652100530 652100540 652100560 652100640 652100650 652100660 652100790 652100800 652100820 652100830 652100840 652100870 652100880 652100900 652100910 652100950 652100960 652100970 652100980 652101010 652101020 652101021 652101030 652101031 652101110 652101180 652101220 652101230 652101240 652101250 652101260 652101270 652101330 652101340 652101370 652101420 652101430 652101440 652101570 652101610 652101630 652101640 652103560 652103810 652103870 652103880 652103920 652104350 652104500 652104730 652104740 652104900 652105050 652105270 652105280 652105460 652105470 652105480 652300040 652300100 652300700 652300990 652400040 652400041 652400130 652400131 652400440 652400441 652400620 652400621 652400630 652400690 652400691 652400700 652400890 652500080 652500081 652500110 652500111 652500120 652500130 652500210 652500211 652500230 652500240 652500320 652600020 652600040 652600140 652600250 652600370 652600374 652600380 652600384 652600390 652600510 652600590 652600640 652600690 652600730 652600740 652600741 652601210 652601250 652601360 652601370 652601520 652903120 652903310 652903320 653000030 653000410 653000411 653001150 653001400 653001770 653001780 653002040 653002990 653003200 653003600 653003670 653005000 653005001 653005002 653005003 653005110 653100260 653100261 653100280 653100320 653100390 653100670 653100770 653100840 653100841 653101000 653101140 653101370 653101371 653101820 653101950 653101951 653102370 653102371 653102590 653102591 653102660 653102670 653200180 653200200 653200600 653300130 653300140 653300141 653300180 653300330 653300331 653300960 653300961 653400020 653400021 653400060 653400500 653400520 653400540 653400790 653400850 653400910 653400920 653401090 653401110 653401260 653401340 653402370 653402520 653402790 670303991 670500090 670500300 670500530 670500540 670600010 670600150 670600151 670600250 670600700 670600790 670601140 670601150 670601410 670601430 670601520 670601590 670601770 670601950 670602120 670602300 670602340 670602350 670602380 670602450 670602920 670602921 670603250 670603260 670603430 670603440 670603580 670603650 670603660 670603710 670603750 670603830 670603930 670603980 670604030 670604031 670604050 670604055 670604180 670604320 670604340 670604343 670605400 670605401 670605490 670605750 670605751 670605790 670606710 670700070 670700280 670700310 670700370 670700371 670700490 670700640 670700641 670701220 670701560 670800020 670800100 670800110 670800120 670800130 670800140 670800141 670800180 670800190 670800210 670800230 670800260 670800261 670800270 670800271 670800290 670800310 670800320 670800340 670800343 670800350 670800351 670800380 670800384 670800410 670800430 670800431 670800440 670800441 670800450 670800453 670800460 670800463 670800500 670800520 670800524 670800940 670800950 670800951 670801000 671700070 671700073 671700110 653500010 653500090 653500170 653500190 653500210 653500280 653500290 653500300 653500310 653500340 653500350 653500360 653500370 653500520 653500521 653500530 653500590 653500610 653500611 653500660 653500661 653500670 653500671 653500690 653500730 653500860 653500861 653500870 653500880 653500890 653500900 653500910 653500920 653500950 653501140 653501240 653501250 653501260 653501270 653501280 653501290 653501340 653501350 653501380 653501390 653501400 653501410 653600010 653600160 653600180 653600190 653600200 653600210 653600250 653600260 653600261 653600290 653600300 653600310 653600520 653600521 653600540 653600550 653600570 653600580 653600590 653600610 653600620 653600750 653600780 653600800 653600830 653600840 653600850 653600860 653600930 653600931 653600960 653601040 653601050 653601060 653601070 653601090 653601120 653601130 653601140 653601150 653601160 653601200 653601220 653601250 653601330 653601340 653601350 653601420 653601430 653601450 653602120 653602121 653602300 671700111 671700610 671700612 671700650 671701790 671701791 671702000 671702090 671800310 671800510 671800520 671800730 671800731 671800770 671800890 671800893 671800920 671800930 671800931 671800950 671801140 671801880 671802220 671802221 671803510 671803514 671805070 671805073 671805230 671805530 671805960 672900060 672900180 672900200 672900210 673100040 673200140 673200230 673200560 674100180 674100181 674900010 674900080 674900082 674900150 674900152 674900340 674900390 674900400 674900410 674900440 674900460 674900470 674900520 675000020 675100010 675500020 675500021 676300010 676300040 676300060 676300070 676300080 676300090 676300100 676300120 677200030 677200031 677200070 677200080 677200110 677200120 677200140 677200141 677200150 677200151 677200152 677200160 677200230 677200240 678000010 678000020 678000090 678000100 678000110 678000160 678000180 678000190 678000290 678000291 678000300 678000301 678800030 678900220 678900230 678900231 678900450 678900470 678900700 678900701 678900702 678900720 678900721 653602320 653700240 653800360 653801460 653801510 653801720 654000010 654000020 654000070 654000071 654000100 654000240 654000270 654000320 654000400 654000410 654000450 654000480 654000481 654000600 654000780 654000830 654000880 654000881 654000900 654000930 654000950 654000960 654001030 654001040 654001070 654001080 654001100 654001170 654001171 654001270 654001340 654001341 654001380 654001410 654001440 654001460 654001530 654001540 654001620 654001720 654001730 654001850 654001910 654002090 654002130 654002290 654002300 654003810 654004610 654100060 654100070 654100090 654100091 654100100 654100110 654100140 654100150 654100160 654100170 654100230 654100250 654100251 654100290 654100300 654100310 654100320 654100321 654302660 654400030 654400040 654400050 654400090 654400091 654400110 654400130 654400150 654400160 654400161 654400200 654400201 654400240 654400270 654400280 654400281 654400290 654400300 654700110 654700120 654801740 655300160 655300170 655300240 655400190 655400310 655400320 655400450 655400451 655400620 655400650 655400660 655400670 655400690 655400691 655400770 655400780 655401180 655401340 655401480 655401482 655401500 655401520 655401550 655401560 655401570 655401590 655401591 655401790 655500010 655500020 655500030 655500070 655500080 655500090 655500110 655500160 655500170 655500180 655500190 655500191 655500200 655500210 655500220 655500240 655500250 655500290 655500291 655500300 655500310 655500320 655500390 655500391 655500550 655500570 655500590 655500600 655500610 655500620 655500630 655500640 655500650 655500670 655500680 655500690 655500700 655500710 655500720 655500730 655500740 655500760 655500771 655500781 655500900 655500910 655500970 655501120 655501210 655501211 655501240 655501320 655501321 655501400 655501540 655501550 655501590 655501591 655501650 655501730 655501740 655501750 655501780 655501790 655501800 655501850 655501860 655501890 655600110 655600750 655600751 655600752 655600770 655601320 655601680 655601681 655601730 655601750 655601800 655601970 655602190 655602200 655602470 655602820 655602840 655603450 655604320 655700020 620500010 620500040 620500050 620500100 621100040 621400220 621400221 621802100 621802510 624900060 624900061 624900070 624900071 624900120 624900121 625900020 625900040 626000160 626200010 626500070 626700010 626700011 626700070 626700072 640000060 640000070 640000090 640000100 640000110 640000210 640000211 640000230 640000310 640000320 640000430 640000470 640000471 640000480 640000520 640000530 640000660 640000670 640000680 640000880 640000881 640000920 640000960 640000970 640001030 640001050 640001070 640001080 640001090 640001110 640001120 640001130 640001150 640001151 640001200 640001260 640001340 640001350 640001370 640001380 640001390 640001400 640001420 640001610 640001620 640001630 640001680 640001690 640001710 640001830 640001831 640002000 640002160 640002180 640002190 640002270 640002271 640002280 640002310 640002330 640002480 640002510 640002511 640002610 640002640 640002650 640002670 640002680 640002760 640002790 640002870 640002890 640002940 640002990 640003330 640003340 640003400 640003410 640003412 640003570 640003580 640003581 640003670 640003810 640003820 640003830 640003840 640003910 640003920 640003930 640003950 640003951 640004320 640004590 640004600 640004850 640004930 640004931 640005470 640005790 640005800 640005980 640006010 640006011 640006170 640006610 640006660 640006740 640006770 640006870 640600020 640900620 640901160 641100030 641100040 641100060 641100100 641100170 641100180 641100190 641100210 641100220 641100230 641100250 641100251 641100270 641100320 641100330 641100331 641100332 641100334 641100350 641100360 641100430 641100450 641100550 641100600 641100660 641100700 641100710 641100750 641100770 641100820 641100840 641100870 641100880 641100890 641100900 641104700 641104710 641104750 641104840 641104850 641104860 641104870 641105690 641105730 641105740 641105750 641105810 641600030 641600110 641600210 641600340 641600360 641600370 641600380 641600390 641600420 641600550 641600570 641600580 641600880 641601030 641601120 641601190 641601230 641601250 641601430 641601440 641601460 641601640 641601641 641601645 641601670 641601750 641601770 641601790 641601800 641601880 641601920 641601960 641601990 641602000 641602010 641602020 641602040 641602060 641602120 641602122 641602390 641602430 641602431 641602470 641602480 641602540 641602590 641602610 641602611 641602620 641603970 641604640 641605420 641605430 641605480 641605600 641605690 641605700 641605710 641605770 641605940 641700060 641700061 641700130 641700480 641700560 641701140 641701170 641701210 641701510 641701520 641701610 641702000 641702010 641702020 641702570 641702580 641704540 641704870 641705030 641800170 641800190 641800300 641800850 641800860 641801440 641801530 641801570 641801640 641802050 641802920 641802921 641802940 641803090 641803680 641805170 641805270 641805272 641805275 641900010 641900011 641900090 641900140 641900141 641900290 641900460 641901020 641901030 641901190 641901191 641901210 641901212 641901220 641901240 641901241 641901270 641901280 641901370 641901440 641901510 641901530 641901870 641901871 641901920 641901970 641902670 641902700 641902710 641903120 641903500 641903510 641904220 641904221 641904222 641905450 641905460 641905680 641905681 641905684 641905940 642000010 642000011 642000030 642000150 642000190 642000191 642000192 642000210 642000211 642000220 642000221 642000320 642000330 642000510 642000530 642000880 642001040 642001290 642001330 642001340 642001350 642001360 642002540 642002920 642100060 642100080 642100150 642100160 642100240 642100250 642100300 642100330 642100410 642100420 642100430 642100440 642100580 642100630 642100640 642100700 642100960 642100970 642100980 642101050 642101070 642101071 642101080 642101090 642101091 642101120 642101220 642101270 642101271 642101330 642101340 642101430 642101460 642101461 642101470 642101520 642101570 642101740 642101930 642101980 642101981 642102010 642102080 642102083 642102130 642102280 642102281 642102282 642102290 642102390 642102410 642102420 642102520 642102550 642102570 642102580 642102660 642104060 642104320 642104321 642104440 642104560 642104590 642104610 642104620 642200070 642200071 642200160 642200220 642200240 642200270 642200390 642200680 642200700 642200800 642200950 642200951 642200970 642201020 642201030 642201040 642201070 642201210 642201220 642201225 642201270 642201271 642201272 642201300 642201340 645000670 645000671 645000730 64500073J 645000740 645000760 645000761 645000820 645000821 645001280 645001281 645100050 645100060 645100080 645100220 645100240 645100250 645100300 645100360 645100380 645100383 645100390 645100410 645100430 645100460 645100470 645100520 645100550 645100551 645100560 645100570 645100580 645100630 645100640 645100643 645100650 645100660 645100661 645100720 645100721 645100740 645100741 645100750 645100751 645100760 645100761 645100770 645100771 645100790 645100800 645100810 645100820 645100860 645100861 645100890 645100892 645100900 645100903 645100920 645100930 645100950 645100951 645100970 645100980 645100990 645101000 645101070 645101090 645101091 645101100 645101110 645101113 645101180 645101190 645101340 645101341 645101370 645101410 645101420 645101660 645101661 645101680 645101681 645101940 645102170 645102280 645102410 645102660 645102670 645102780 645102783 645102940 645103820 645103821 645203760 645203761 645203930 645203931 645300260 645300310 645300311 645300370 645300590 645300680 645300750 645300751 645300920 645300921 645300930 645300931 645300990 645301000 645301050 645301051 645301100 645301130 645301200 645301210 645301370 645301500 645301580 645301610 645301620 645301730 645301734 645301960 645301970 645301971 645302130 645302132 645302370 645302371 645302630 645302660 645302830 645302870 645302980 645302983 645303040 645303050 645303130 645303131 645304200 645304201 645304440 645304441 645400010 645400011 645400040 645400060 645400090 645400120 645400180 645400190 645400200 645400340 645400360 645400390 645400392 645400480 645400610 645400680 645400800 645400810 645400830 645400850 645400880 645401150 645401190 645401191 645401240 645401290 645401300 645401330 645401360 645401380 645401440 645401480 645401540 645401820 645401860 645401870 645401880 645401910 645401911 645401930 645401940 645402220 645402222 645402290 645402291 645402380 645402930 645403280 645403290 645403480 645403560 645403640 645403680 645403740 645403830 645600190 645600390 645600400 645600410 645600850 645601910 645602070 645602180 645602181 645602250 645700350 645700550 645700551 645700552 645700560 645700564 645700690 645700700 645700790 645700791 645700792 645700860 645700890 645700891 645701150 645701190 645900310 645900990 645902320 645902322 645902470 645902480 645902650 645902800 645902801 645903000 645903001 645903040 645903041 645903170 645905140 646000300 646000302 646001150 646200890 646201110 646201140 646202230 646202231 646300110 646500320 646500340 646500370 646500400 646500410 646600770 646600840 646600860 646600890 646601030 646601031 646601200 646601210 646601230 646601400 646601450 646601460 646601470 646601510 646601580 646800120 646800200 646800810 646800812 646800830 646800870 646800880 646800920 646800950 646800951 646801020 646801100 646801120 646801230 646801380 646802470 646802471 646802630 646802631 646802660 646900030 646900050 646900090 646900100 646900110 646900280 646900320 646900340 646900430 646900470 646900500 646900510 646900550 646900560 646900600 646900610 646900660 646900690 646900700 646900710 646900800 646900870 646900880 646901010 646901020 646901040 646901300 646901301 646901400 646901410 646901420 646901450 646901460 646901630 646901830 647201500 647300950 647500350 647500550 647500580 647500750 647501480 647601040 647800080 647800110 647800190 647800200 647800530 647800630 647800720 647800740 647800750 647800760 647800761 647800960 647800990 647800991 647801010 647801020 647801021 647801080 647801120 647801121 647801130 647801600 647801601 647801720 647801830 647801910 647802030 647802140 647802240 647802290 647802340 647802390 647802391 647802430 647802460 647802470 647802471 647802480 647802481 647802570 647802630 647802730 647802740 647802741 647802750 647803470 647803540 647803541 647803620 647803621 647803630 647803640 647803660 647803670 647803800 647803801 647803820 647803830 647803880 647803890 647803900 647803910 647803920 647803940 647803950 647803960 647803980 647804010 647804020 647804060 647804090 647804150 647804160 647804220 648000070 648000540 648100320 648100380 648100470 648100500 648100510 648100640 648100790 648101500 648101520 648101560 648101660 648101670 648102000 648102090 648102091 648102240 648102410 648102900 648103380 648103381 648103490 648103500 648103510 648103530 648103531 648103540 648200500 648200940 648201160 648203540 648400010 648500020 648500021 648500100 648500150 648500160 648500170 648500260 648500340 648500460 648500500 648500502 648500530 648500570 648500610 648500640 648500660 648500680 648500790 648500820 648500920 648500950 648501310 648501470 648501750 648501840 648501841 648501950 648501951 648502040 648502041 648502080 648502200 648502240 648502280 648502283 648502360 648502361 648502380 648502440 648502450 648502453 648502530 648502580 648502620 648502621 648502720 648502721 648502740 648502750 648502850 648502851 648503010 648503120 648503290 648503291 648503320 648503321 648503330 648503331 648503350 648503380 648503390 648503550 648503580 648503590 648503690 648503720 648503770 648503780 648503970 648504080 648504090 648504100 648504101 648504220 648504230 648504231 648504260 648504270 648506410 648506560 648506590 648506591 648506690 648506691 648601310 648900030 648900040 648900060 648900070 648900080 648900150 648900160 648900170 648900180 648900181 648900190 648900220 648900230 648900240 648900250 648900260 648900270 648900280 648900300 648900310 648900330 648900350 648900370 648900371 648900390 648900400 648900450 648900490 648900540 648900560 648900610 648900620 648900640 648900650 648900660 648900710 648900720 648900721 648900740 648900741 648900810 648900830 648900870 648900871 648900880 648900890 648900891 648900910 648900920 648900930 648900960 648900970 648901010 648901020 648901030 648901040 648901060 648901080 648901081 648901170 648901171 648901180 648901182 648901200 648901210 648901220 648901240 648901260 648901310 648901311 648901320 648901330 648901340 648901800 648901802 648902000 648902110 648902180 648902181 648902270 648902380 648902420 649001010 649001011 649001020 649001021 649100100 649100110 649100470 649101070 649101320 649200010 649400510 649500350 649500490 649500491 649501370 649501530 649501540 649502160 649502440 649504610 649505100 649506080 649506090 649506180 649506181 649506390 649602010 649602350 649602730 649602731 649604100 649604140 649604141 649800040 649800050 649800051 649800210 649800340 649800341 649800350 649800351 649800460 649800480 649800850 649800940 649800960 649800990 649801230 649801380 649801740 649801760 649801880 649802240 649802380 649802381 649802460 649802480 649802520 649802570 649802950 649804230 649805170 649805350 649805820 649806600 649900060 649900110 649900120 649900190 649900200 649900280 650000090 650000120 650000121 650000122 650000170 650000180 650000190 650000260 650000261 65000026J 650000270 650000280 650000330 650000380 650000400 650000450 650000452 650000470 650000471 650000490 650000491 650000580 650000590 650000591 650000600 650000601 650000620 650000621 650000630 650000631 650000760 650000770 650000780 650000880 650000881 650000910 650000990 650001050 650001230 650001450 650001460 650001470 650001480 650001490 650001560 650001640 650001641 650001660 650001661 650001800 650001830 650001831 650001870 650001880 650001890 650001900 650001910 650001911 650001930 650001940 650001960 650001970 650001980 650002370 650002371 650002380 650002381 650002450 650002460 650002470 650002540 650002570 650002640 650002650 650002670 650002700 650002720 650002730 650002780 650002790 650002930 650002940 650002960 650100010 650100011 650100020 650100023 650100030 650100040 650100070 650100140 650100141 650100142 650100170 650100175 650100390 650100400 650100640 650100750 650100751 650101060 650101100 650101130 650101310 650101311 650101320 650101321 650101450 650101620 650101621 650101630 650101631 650101670 650101671 650102310 650102315 650102430 650102670 650102690 650102740 650200400 650200710 650200711 650200860 650200861 650200862 650201050 650201560 650201660 650201700 650201970 650202180 650202470 650202500 650202670 650202671 650202970 650203440 650203650 650203651 650203656 650300220 650300230 650300500 650300590 650300780 650300870 650301030 650301070 650301080 650301200 650301210 650301460 650301520 650301560 650301570 650400010 650500090 650500091 650500240 650500241 650500243 650500400 650500420 655700021 655700030 655700031 655700050 655700100 655700102 655800220 655900180 655901040 655901390 655901620 655901640 655901670 655901720 655902530 655902750 655902770 655902790 655903190 655903740 655903800 655904240 656000350 656000380 656000450 656000740 656001020 656001650 656200700 656200710 656201250 656201300 656300070 656400240 656700020 656700022 656701370 657200090 657200130 657200140 657200200 657200210 657200220 657200240 657200310 657200370 657200480 657200490 657200500 657200570 657200600 657200650 657200850 657200860 657201000 657201010 657201020 657201040 657201050 657201120 657201140 657201230 657201240 657202140 657202360 657300300 657300390 657300391 657300510 657300660 657300850 657301400 657301550 657302430 657302670 657304390 657304620 657305780 657400120 657400160 657400260 657400320 657400390 657500370 657800020 657800130 657800131 657800220 657800280 657800300 657800440 657800820 657800890 657801060 657801100 657801300 657801301 657801410 657801450 657801460 657801480 657801481 657801800 657801801 657801830 657801900 657801910 657801950 657801951 657802030 657802100 657802110 678900981 678900992 679400030 679400031 679400100 679400102 679400120 679400121 679400160 679400161 679700100 679700101 680500560 680900010 680900020 680900030 680900050 680900060 680900070 680900090 680900110 681800010 684900020 684900040 686500010 688900010 689100520 692000050 692000130 693400080 693400120 693400122 693500250 693500251 693900070 693900080 694000030 694000080 694000120 694000160 694000200 694000201 694000250 694000260 694000300 694000310 694000320 694000500 694000510 694000560 696300010 696300011 696300020 696300050 696300060 696300080 696300110 696300120 696300130 696300140 696300150 696300160 696300200 696300210 696300220 696300290 696300310 696300320 696300330 696300340 696500010 697100230 697100240 697100380 698001940 698800010 698800011 699600010 699903190 699903570 699903600 644700590 645403700 648900060 648900070 653102970 647801211 647801221 647801231 642507290 647804390 645403720 645403730 645000490 642104280 642103040 642104630 642104080 648900550 642507300 654400551 642507350 642507340 642507360 651902520 651902590 651903200 651903580 650001850 650001860 650001870 651900500 670700270 653600580 653602090 653600590 653601410 653600600 653602080 642104810 642104820 642104800 649801721 693500401 643507280 643507260 643507270 '
edis = edis.split()
ret = []
for i in range(0, len(edis),100):
	fld = rec = []
	kw = ' '.join(edis[i:i+100])
	ret += d.GetDrugSearchTable(kw, not i)

print(ret)
WriteToCSV(ret,'test.csv')
